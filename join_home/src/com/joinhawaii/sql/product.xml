<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="product">
	<select id="select_product" parameterType="map" resultType="map">
		select prod_id, prod_name, prod_gubn, display_gubn, prod_simple_desc, location,
			prod_info, adult_sales_price, kid_sales_price, sort_flag, use_yn, img_path_00,
			img_path_01, img_path_02, prod_include,  prod_pic, prod_exclude, prod_inquire, prod_air
		  from yeosi_prod_master
		 where 1 = 1
		 <if test="use_yn != null">
		   and use_yn =#{use_yn}
		 </if>
		 <if test="prod_id != null">
		   and prod_id = #{prod_id}
		 </if>
		 <if test="prod_gubn != null">
		   and prod_gubn = #{prod_gubn}
		 </if>
		 <if test="location != null">
		   and location = #{location}
		 </if>
		 <if test="display_gubn != null">
		   and display_gubn = #{display_gubn}
		 </if>
		 <if test="not_display_gubn != null">
		   <![CDATA[and display_gubn <> #{not_display_gubn}]]>
		 </if>
		 <if test="prod_name != null">
		   and prod_name like CONCAT('%', #{prod_name}, '%')
		 </if>
		 order by sort_flag, prod_id
	</select>
	
	<select id="select_product_title" parameterType="map" resultType="map">
		select prod_id, prod_name
		  from yeosi_prod_master
		 where 1 = 1
		 <if test="use_yn != null">
		   and use_yn =#{use_yn}
		 </if>
		 <if test="prod_id != null">
		   and prod_id = #{prod_id}
		 </if>
		 <if test="prod_gubn != null">
		   and prod_gubn = #{prod_gubn}
		 </if>
		 <if test="location != null">
		   and location = #{location}
		 </if>
		 <if test="display_gubn != null">
		   and display_gubn = #{display_gubn}
		 </if>
		 <if test="prod_name != null">
		   and prod_name like CONCAT('%', #{prod_name}, '%')
		 </if>
		 order by sort_flag, prod_id
	</select>	
	
	<insert id="insert_product" parameterType="map">
		insert into yeosi_prod_master (prod_name, prod_gubn, display_gubn, prod_simple_desc, 
				location, prod_info, adult_sales_price, kid_sales_price, sort_flag, use_yn, 
				img_path_00, img_path_01, img_path_02, prod_include, prod_inquire, prod_air,
				prod_pic, prod_exclude, init_user, init_date) values (
			   #{prod_name}, #{prod_gubn}, #{display_gubn}, #{prod_simple_desc},
			   #{location}, #{prod_info}, #{adult_sales_price}, #{kid_sales_price}, #{sort_flag}, 
			   'Y', #{img_path_00}, #{img_path_01}, #{img_path_02}, #{prod_include}, #{prod_inquire}, 
			   #{prod_air}, #{prod_pic}, #{prod_exclude}, #{init_user}, now()) 
		<selectKey resultType="int" keyProperty="prod_id" order="AFTER">
			select last_insert_id()
		</selectKey>
	</insert>
	
	<select id="select_product_schedule" parameterType="map" resultType="map">
		select day_seq, detail_schedule
		  from yeosi_prod_schedule
		 where prod_id = #{prod_id}
		 order by day_seq
	</select>
	
	<insert id="insert_product_schedule" parameterType="map">
		insert into yeosi_prod_schedule (prod_id, day_seq, detail_schedule, init_date, init_user) 
								values (#{prod_id}, #{day_seq}, #{detail_schedule}, now(), #{init_user})	
	</insert>
	
	<delete id="delete_product_schedule" parameterType="map">
		delete from yeosi_prod_schedule where prod_id = #{prod_id}
	</delete>
	
	<update id="update_prod_sortflag_useyn" parameterType="map">
		update yeosi_prod_master
		   set sort_flag = #{sort_flag}
		      , use_yn = #{use_yn}
		 where prod_id = #{prod_id}
	</update>
	
	<update id="update_product" parameterType="map">
		update yeosi_prod_master 
				set prod_name = #{prod_name}
					, display_gubn = #{display_gubn}
					, prod_simple_desc = #{prod_simple_desc}
					, prod_info = #{prod_info}
					, adult_sales_price = #{adult_sales_price}
					, kid_sales_price = #{kid_sales_price}
					, img_path_00 = #{img_path_00}
					, img_path_01 = #{img_path_01}
					, img_path_02 = #{img_path_02}
					, prod_include = #{prod_include}
					, prod_exclude = #{prod_exclude}
					, prod_inquire = #{prod_inquire}
					, prod_pic = #{prod_pic}
					, prod_air = #{prod_air}
					, up_user = #{up_user}
					, up_date = now()
		 where prod_id = #{prod_id}
	</update>
	
	<delete id="delete_product" parameterType="map">
		delete 
		  from yeosi_prod_master
		 where prod_id = #{prod_id}
	</delete>
	
</mapper>