<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="gallery">

	<insert id="insert_GalleryList" parameterType="map">
		insert into tb_join_gallery (
			  parent_id
			, gallery_gubn
			, gallery_info
			, gallery_img_path
			, ordering
			, regist_datetime
			, regist_user
		) values (
			  #{parent_id}
			, #{gallery_gubn}
			, #{gallery_info}
			, #{gallery_img_path}
			, case #{ordering} when '' then 0 when (#{ordering} is NULL) then 0 else #{ordering} end
			, date_format(now(), '%Y%m%d%H%i%s')
            , #{regist_user}
		)
	</insert>
	
	<update id="update_GalleryList" parameterType="map">
		update tb_join_gallery
			set gallery_info     = #{gallery_info}
			  , gallery_img_path = #{gallery_img_path}
			  , ordering         = case #{ordering} when '' then 0 when (#{ordering} is NULL) then 0 else #{ordering} end
			  , change_datetime  = date_format(now(), '%Y%m%d%H%i%s')
			  , change_user      = #{change_user}
		 where gallery_id   = #{gallery_id}
		   and parent_id    = #{parent_id}
		   and gallery_gubn = #{gallery_gubn} 
	</update>
	
	<delete id="delete_GalleryList" parameterType="map">
		delete
		  from tb_join_gallery
		 where parent_id = #{parent_id}
		 <if test="gallery_id != null and gallery_id != ''">
		   and gallery_id = #{gallery_id}
		 </if>
		 <if test="gallery_gubn != null and gallery_gubn != ''">
		   and gallery_gubn = #{gallery_gubn}
		 </if>
	</delete>
	
	<select id="select_GalleryList" parameterType="map" resultType="map">
		select gallery_id
			 , parent_id
			 , gallery_gubn
			 , gallery_info
			 , gallery_img_path
			 , ordering 
		  from tb_join_gallery
		 where 1 = 1
		 <if test="hotel_id != null and hotel_id != ''">
		   and parent_id = #{hotel_id}
		 </if> 
		 <if test="parent_id != null and parent_id != ''">
		   and parent_id = #{parent_id}
		 </if>
		 <if test="gallery_gubn != null and gallery_gubn != ''">
		   and gallery_gubn = #{gallery_gubn}
		 </if>		  
		 order by ordering
	</select>
	
</mapper>
