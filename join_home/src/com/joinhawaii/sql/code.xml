<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="code">
	<select id="select_simpleCodeList" parameterType="map" resultType="map">
		select code, code_gubn, code_name
		  from tb_join_code
		 where code_gubn = #{code_gubn}
		 order by sort_flag, code
	</select>
	
	<select id="select_CodeList" parameterType="map" resultType="map">
		select code, code_gubn, code_name, code_desc, code_info, code_num1, code_num2, sort_flag, use_yn
		  from tb_join_code
		 where code_gubn = #{s_code_gubn}
		 order by sort_flag, code
	</select>
	
	<insert id="insert_Code" parameterType="map">
		insert into tb_join_code (code, code_gubn, code_name, code_desc, code_info, code_num1, 
		                               code_num2, sort_flag, use_yn, regist_datetime, regist_user)
		values (#{code}, #{code_gubn}, #{code_name}, #{code_desc}, #{code_info}, case #{code_num1} when '' then 0 else #{code_num1} end,
		        case #{code_num2} when '' then 0 else #{code_num2} end, #{sort_flag}, #{use_yn}, date_format(now(), '%Y%m%d%H%i%s'), #{regist_user})
	</insert>
	
	<update id="update_Code" parameterType="map">
		update tb_join_code 
		   set code_name = #{code_name}
		      , code_desc = #{code_desc}
		      , code_info = #{code_info}
		      , code_num1 = case #{code_num1} when '' then 0 else #{code_num1} end
		      , code_num2 = case #{code_num2} when '' then 0 else #{code_num2} end
		      , sort_flag = #{sort_flag}
		      , use_yn = #{use_yn}
		      , change_datetime = date_format(now(), '%Y%m%d%H%i%s')
		      , change_user = #{change_user}
		 where code = #{code}
	</update>
	
	<delete id="delete_Code" parameterType="map">
		delete from tb_join_code
		 where code = #{code}
	</delete>
	
	<select id="select_CodeTitle" parameterType="map" resultType="map">
		select code, code_gubn, code_name
			 , case code_desc when '' then '기타1' when NULL then '기타1' else code_desc end as code_desc
			 , case code_info when '' then '기타2' when NULL then '기타2' else code_info end as code_info
		  from tb_join_code
		 where code_gubn = '000'
		   and code = #{code}
	</select>
</mapper>